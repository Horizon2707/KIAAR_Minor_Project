const final_calc = {
  // 12: {
  //   1: {
  //     6: {
  //       1: 0,
  //     },
  //     8: {
  //       1: 0,
  //     },
  //     9: {
  //       1: 0,
  //     },
  //     10: {
  //       1: 0,
  //     },
  //     27: {
  //       1: 123.4,
  //     },
  //     28: {
  //       1: 148.5,
  //     },
  //     29: {
  //       1: 73.9,
  //     },
  //     47: {
  //       1: 0,
  //     },
  //   },
  //   2: {
  //     27: {
  //       1: 80,
  //     },
  //     28: {
  //       1: 93.9,
  //     },
  //     29: {
  //       1: 49.1,
  //     },
  //   },
  //   3: {
  //     27: {
  //       1: 32.4,
  //     },
  //     28: {
  //       1: 66.6,
  //     },
  //     29: {
  //       1: 36.7,
  //     },
  //   },
  // },
  103: {
    1: {
      20: {
        1: 20.5,
        2: 41.1,
        3: 41.1,
        4: 51.4,
        5: 51.4,
        0: 205.4,
      },
      23: {
        1: 160.7,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 160.7,
      },
      32: {
        1: 24.8,
        2: 49.5,
        3: 49.5,
        4: 61.9,
        5: 61.9,
        0: 247.5,
      },
    },
    2: {
      20: {
        1: 13.2,
        2: 26.4,
        3: 26.4,
        4: 33,
        5: 33,
        0: 132.2,
      },
      23: {
        1: 106.7,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 106.7,
      },
      32: {
        1: 15.7,
        2: 31.3,
        3: 31.3,
        4: 39.1,
        5: 39.1,
        0: 156.5,
      },
    },
    3: {
      20: {
        1: 3.9,
        2: 7.8,
        3: 7.8,
        4: 9.8,
        5: 9.8,
        0: 39.2,
      },
      23: {
        1: 79.8,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 79.8,
      },
      32: {
        1: 11.1,
        2: 22.2,
        3: 22.2,
        4: 27.8,
        5: 27.8,
        0: 111,
      },
    },
  },
  104: {
    1: {
      20: {
        1: 26.8,
        2: 53.7,
        3: 53.7,
        4: 67.1,
        5: 67.1,
        0: 268.3,
      },
      25: {
        1: 461.9,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 461.9,
      },
      32: {
        1: 24.8,
        2: 49.5,
        3: 49.5,
        4: 61.9,
        5: 61.9,
        0: 247.5,
      },
    },
    2: {
      20: {
        1: 17.4,
        2: 34.8,
        3: 34.8,
        4: 43.5,
        5: 43.5,
        0: 173.9,
      },
      25: {
        1: 306.9,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 306.9,
      },
      32: {
        1: 15.7,
        2: 31.3,
        3: 31.3,
        4: 39.1,
        5: 39.1,
        0: 156.5,
      },
    },
    3: {
      20: {
        1: 7,
        2: 14.1,
        3: 14.1,
        4: 17.6,
        5: 17.6,
        0: 70.4,
      },
      25: {
        1: 229.4,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 229.4,
      },
      32: {
        1: 11.1,
        2: 22.2,
        3: 22.2,
        4: 27.8,
        5: 27.8,
        0: 111,
      },
    },
  },
  105: {
    1: {
      20: {
        1: 17.8,
        2: 35.6,
        3: 35.6,
        4: 44.5,
        5: 44.5,
        0: 177.9,
      },
      24: {
        1: 230.9,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 230.9,
      },
      32: {
        1: 18.6,
        2: 37.2,
        3: 37.2,
        4: 46.5,
        5: 46.5,
        0: 185.9,
      },
    },
    2: {
      20: {
        1: 11.4,
        2: 22.8,
        3: 22.8,
        4: 28.5,
        5: 28.5,
        0: 113.9,
      },
      24: {
        1: 153.4,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 153.4,
      },
      32: {
        1: 11.6,
        2: 23.1,
        3: 23.1,
        4: 28.9,
        5: 28.9,
        0: 115.6,
      },
    },
    3: {
      20: {
        1: 2.6,
        2: 5.1,
        3: 5.1,
        4: 6.4,
        5: 6.4,
        0: 25.6,
      },
      24: {
        1: 114.7,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 114.7,
      },
      32: {
        1: 8,
        2: 16.1,
        3: 16.1,
        4: 20.1,
        5: 20.1,
        0: 80.4,
      },
    },
  },
  106: {
    1: {
      20: {
        1: 20.7,
        2: 41.3,
        3: 41.3,
        4: 51.6,
        5: 51.6,
        0: 206.5,
      },
      22: {
        1: 284.2,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 284.2,
      },
      32: {
        1: 12.4,
        2: 24.9,
        3: 24.9,
        4: 31.1,
        5: 31.1,
        0: 124.3,
      },
    },
    2: {
      20: {
        1: 13.3,
        2: 26.6,
        3: 26.6,
        4: 33.2,
        5: 33.2,
        0: 132.9,
      },
      22: {
        1: 188.8,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 188.8,
      },
      32: {
        1: 7.5,
        2: 14.9,
        3: 14.9,
        4: 18.7,
        5: 18.7,
        0: 74.7,
      },
    },
    3: {
      20: {
        1: 4,
        2: 7.9,
        3: 7.9,
        4: 9.9,
        5: 9.9,
        0: 39.7,
      },
      22: {
        1: 141.2,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        0: 141.2,
      },
      32: {
        1: 5,
        2: 10,
        3: 10,
        4: 12.4,
        5: 12.4,
        0: 49.8,
      },
    },
  },
};

// const nutrients = final_calc[12];
// codesToRetrieve = [27, 28, 29];
// codesToRetrieve.forEach((code) => {
//   const valuesForCode = {};
//   let x = 0;
//   Object.keys(nutrients).forEach((level) => {
//     console.log(nutrients[level][code]["1"]);
//   });
//   console.log(`Values for code ${code}:`, valuesForCode);
// });

// final_calc.forEach((season) => {
//   // const season_cd = Object.keys(season);
//   // console.log(season_cd);
//   console.log(1);
// });
// combination_cd = [
//   { COMBINATION_CD: 12, COMBINATION_NAME: "MICRO NUTRIENTS" },
//   { COMBINATION_CD: 103, COMBINATION_NAME: "COMBINATION-01" },
//   { COMBINATION_CD: 105, COMBINATION_NAME: "COMBINATION-03" },
//   { COMBINATION_CD: 106, COMBINATION_NAME: "COMBINATION-04" },
//   { COMBINATION_CD: 104, COMBINATION_NAME: "COMBINATION-02" },
// ];
// function getCombinationName(code) {
//   const found = combination_cd.find((item) => item[`COMBINATION_CD`] === code);
//   return found ? found["COMBINATION_NAME"] : "NOT FOUND";
// }
// for (const comb_cd in final_calc) {
//   console.log(getCombinationName(comb_cd));
// }
// function getCombinationName(code) {
//   const found = combination_cd.find(
//     (item) => item.COMBINATION_CD === parseInt(code)
//   );
//   return found ? found.COMBINATION_NAME : "NOT FOUND";
// }
// function getProductName(code) {
//   const found = product_cd.find((item) => item[`PRODUCT_CD`] === code);
//   return found ? found["SW_PRODUCT_NAME"] : "NOT FOUND";
// }
// function getSeasonName(code) {
//   const found = crop_season_cd.find((item) => item[`CROP_SEASON_CD`] === code);
//   return found ? found["CROP_SEASON"] : "NOT FOUND";
// }
// function getTimeApply(code) {
//   const found = time_apply_cd.find(
//     (item) => item[`RECOM_APPLY_TIME_CD`] === code
//   );
//   return found ? found["RECOM_APPLY_TIME"] : "NOT FOUND";
// }
// // Object.keys(final_calc).forEach((comb_cd) => {
// //   console.log(typeof comb_cd); // Debug statement to check the type of comb_cd
// //   console.log(getCombinationName(comb_cd));
// // });
// console.log(getProductName(23));
// console.log(getSeasonName(1));
// console.log(getTimeApply(1));
// console.log(getCombinationName(103));

// const recomm = {
//   12: {
//     1: {
//       6: { 1: 0 },
//       8: { 1: 0 },
//       9: { 1: 0 },
//       10: { 1: 0 },
//       27: { 1: "nitr_A" },
//       28: { 1: "pota_A" },
//       29: { 1: "phos_A" },
//       47: { 1: 0 },
//     },
//     2: {
//       27: { 1: "nitr_P" },
//       28: { 1: "pota_P" },
//       29: { 1: "phos_P" },
//     },
//     3: {
//       27: { 1: "nitr_S" },
//       28: { 1: "pota_S" },
//       29: { 1: "phos_S" },
//     },
//   },
//   103: {
//     1: {
//       23: { 0: "c1_DAP_0_A", 1: "c1_DAP_0_A", 2: 0, 3: 0, 4: 0, 5: 0 },
//       32: {
//         0: "c1_MOP_0_A",
//         1: "c1_MOP_TA1_A",
//         2: "c1_MOP_TA2_A",
//         3: "c1_MOP_TA3_A",
//         4: "c1_MOP_TA4_A",
//         5: "c1_MOP_TA5_A",
//       },
//       20: {
//         0: "c1_UREA_0_A",
//         1: "c1_UREA_TA1_A",
//         2: "c1_UREA_TA2_A",
//         3: "c1_UREA_TA3_A",
//         4: "c1_UREA_TA4_A",
//         5: "c1_UREA_TA5_A",
//       },
//     },
//     2: {
//       23: { 0: "c1_DAP_0_P", 1: "c1_DAP_0_P", 2: 0, 3: 0, 4: 0, 5: 0 },
//       32: {
//         0: "c1_MOP_0_P",
//         1: "c1_MOP_TA1_P",
//         2: "c1_MOP_TA2_P",
//         3: "c1_MOP_TA3_P",
//         4: "c1_MOP_TA4_P",
//         5: "c1_MOP_TA5_P",
//       },
//       20: {
//         0: "c1_UREA_0_P",
//         1: "c1_UREA_TA1_P",
//         2: "c1_UREA_TA2_P",
//         3: "c1_UREA_TA3_P",
//         4: "c1_UREA_TA4_P",
//         5: "c1_UREA_TA5_P",
//       },
//     },
//     3: {
//       23: { 0: "c1_DAP_0_S", 1: "c1_DAP_0_S", 2: 0, 3: 0, 4: 0, 5: 0 },
//       32: {
//         0: "c1_MOP_0_S",
//         1: "c1_MOP_TA1_S",
//         2: "c1_MOP_TA2_S",
//         3: "c1_MOP_TA3_S",
//         4: "c1_MOP_TA4_S",
//         5: "c1_MOP_TA5_S",
//       },
//       20: {
//         0: "c1_UREA_0_S",
//         1: "c1_UREA_TA1_S",
//         2: "c1_UREA_TA2_S",
//         3: "c1_UREA_TA3_S",
//         4: "c1_UREA_TA4_S",
//         5: "c1_UREA_TA5_S",
//       },
//     },
//   },
//   104: {
//     // Object content for 104
//   },
//   105: {
//     // Object content for 105
//   },
//   106: {
//     // Object content for 106
//   },
// };

// // Create a new Excel workbook
// const wb = new xl.Workbook();

// // Add a worksheet to the workbook
// const ws2 = wb.addWorksheet("Recommendations");

// // Function to recursively iterate over the object and add data to the Excel sheet
// function addDataToSheet(obj, rowNum = 1) {
//   for (const key in obj) {
//     if (typeof obj[key] === "object") {
//       // If it's an object, recurse
//       addDataToSheet(obj[key], rowNum);
//     } else {
//       // If it's a value, add it to the Excel sheet
//       ws2.cell(rowNum, 1).number(parseInt(key)); // Assuming key is a number
//       ws2.cell(rowNum, 2).number(parseInt(Object.keys(obj[key])[0])); // Assuming obj[key] has only one key
//       ws2
//         .cell(rowNum, 3)
//         .number(parseInt(Object.keys(obj[key][Object.keys(obj[key])[0]])[0])); // Assuming obj[key][Object.keys(obj[key])[0]] has only one key
//       ws2
//         .cell(rowNum, 4)
//         .string(
//           obj[key][Object.keys(obj[key])[0]][
//             Object.keys(obj[key][Object.keys(obj[key])[0]])[0]
//           ].toString()
//         ); // Assuming obj[key][Object.keys(obj[key])[0]][Object.keys(obj[key][Object.keys(obj[key])[0]])[0]] is a string
//       rowNum++;
//     }
//   }
// }

// // Call the function to populate the Excel sheet
// addDataToSheet(recomm);

// // Write the Excel file to disk
// wb.write("recommendations.xlsx", (err, stats) => {
//   if (err) {
//     console.error("Error writing Excel report:", err);
//   } else {
//     console.log("Excel report generated successfully!");
//   }
// });

// delete final_calc[12];
const order = [
  { 103: [23, 32, 20] },
  { 104: [25, 32, 20] },
  { 105: [24, 32, 20] },
  { 106: [22, 32, 20] },
];
const season_keys = [1, 2, 3];

function rearrangeInnerObjects(finalCalc) {
  const rearrangedFinalCalc = {};

  for (const item of order) {
    const key = Object.keys(item)[0];
    const orderedKeys = item[key];

    if (finalCalc.hasOwnProperty(key)) {
      rearrangedFinalCalc[key] = {};

      for (const season of season_keys) {
        rearrangedFinalCalc[key][season] = {};

        for (const product of orderedKeys) {
          if (finalCalc[key].hasOwnProperty(season)) {
            rearrangedFinalCalc[key][season][product] =
              finalCalc[key][season][product];
          }
        }
      }
    }
  }

  return rearrangedFinalCalc;
}

const rearrangedFinalCalc = rearrangeInnerObjects(final_calc);
console.log(rearrangedFinalCalc);
